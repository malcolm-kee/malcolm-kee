---
import { TodayILearnt } from '~/components/TodayILearnt';
import { getTilByTopic } from '~/data/til-helpers';
import BaseHead from '../components/BaseHead.astro';
import PageLayout from '../components/PageLayout.astro';

const title = 'Today I Learnt - Malcolm Kee';
const description = `Inspired by Stefan Judis, these are the little facts I learnt in my daily life as a Frontend Engineer.`;

const tilMap = await getTilByTopic();

const { pathname } = Astro.url;

const permalink = new URL(pathname.replace(/\/$/, ''), Astro.site).toString();
---

<html lang="en">
  <head>
    <BaseHead title={title} description={description} permalink={permalink} />
  </head>
  <body>
    <PageLayout>
      <span slot="title">Today I Learnt</span>
      <span slot="description">
        Inspired by <a
          href="https://www.stefanjudis.com/today-i-learned/"
          class="hover:underline">Stefan Judis</a
        >, these are the little facts I learnt in my daily life as a Frontend
        Engineer.
      </span>
      <div
        class="grid grid-cols-[repeat(auto-fit,minmax(15em,1fr))] gap-8 items-start -mx-3"
      >
        {
          [...tilMap].map(([topic, tils]) => (
            <div class="border-l border-transparent sm:hover:border-zinc-100 pb-2">
              <h2 class="text-sm px-3 font-medium text-zinc-400 uppercase">
                {topic}
              </h2>
              <TodayILearnt className="mt-3">
                {tils.map((til) => (
                  <TodayILearnt.Item til={til} />
                ))}
              </TodayILearnt>
            </div>
          ))
        }
      </div>
    </PageLayout>
  </body>
</html>
