---
import { clsx } from 'clsx';
import { Button } from './Button';

export interface Props {
  class?: string;
}

const props = Astro.props;
---

<div
  class={clsx(
    'hidden installable:mode-browser:block max-w-2xl mx-auto p-4 sm:p-10 rounded shadow text-center',
    props.class
  )}
>
  <p class="text-2xl font-medium text-zinc-600 mb-3">Prefer to get updates in your phone?</p>
  <p class="text-zinc-600 mb-3">
    Install this website locally and get notified when a new blog is published <span
      class="line-through">after I figure out how to do web push</span
    >.
  </p>
  <div>
    <Button className="installBtn w-full" data-success>
      <span class="text-lg px-3">Install</span>
    </Button>
  </div>
</div>
<script>
  document.querySelectorAll('.installBtn').forEach((installBtn) => {
    installBtn.addEventListener('click', () => {
      if (promptInstall && typeof promptInstall.prompt === 'function') {
        promptInstall.prompt();
        promptInstall = undefined;
        delete document.documentElement.dataset.installable;
      }
    });
  });
</script>
